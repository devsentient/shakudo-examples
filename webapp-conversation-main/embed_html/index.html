<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dify App</title>
    <script>
        window.difyChatbotConfig = { 
            token: 'DIVEHvxgLfj3QsCi', 
            baseUrl: 'https://dify.dev.hyperplane.dev'
        }
    </script>
    <script defer id="DIVEHvxgLfj3QsCi">
        async function embedChatbot() {
            const t = window.difyChatbotConfig;
            if (t && t.token) {
                var e = !!t.isDev;
                const o = t.baseUrl || `https://${e ? "dev." : ""}udify.app`,
                    n = `<svg width="50" height="26" viewBox="0 0 50 26" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <g id="Dify">
                        <path d="M6.61784 2.064C8.37784 2.064 9.92184 2.408 11.2498 3.096C12.5938 3.784 13.6258 4.768 14.3458 6.048C15.0818 7.312 15.4498 8.784 15.4498 10.464C15.4498 12.144 15.0818 13.616 14.3458 14.88C13.6258 16.128 12.5938 17.096 11.2498 17.784C9.92184 18.472 8.37784 18.816 6.61784 18.816H0.761841V2.064H6.61784ZM6.49784 15.96C8.25784 15.96 9.61784 15.48 10.5778 14.52C11.5378 13.56 12.0178 12.208 12.0178 10.464C12.0178 8.72 11.5378 7.36 10.5778 6.384C9.61784 5.392 8.25784 4.896 6.49784 4.896H4.12184V15.96H6.49784Z" fill="#1D2939"/>
                        <path d="M20.869 3.936C20.277 3.936 19.781 3.752 19.381 3.384C18.997 3 18.805 2.528 18.805 1.968C18.805 1.408 18.997 0.944 19.381 0.576C19.781 0.192 20.277 0 20.869 0C21.461 0 21.949 0.192 22.333 0.576C22.733 0.944 22.933 1.408 22.933 1.968C22.933 2.528 22.733 3 22.333 3.384C21.949 3.752 21.461 3.936 20.869 3.936ZM22.525 5.52V18.816H19.165V5.52H22.525Z" fill="#1D2939"/>
                        <path d="M33.1407 8.28H30.8127V18.816H27.4047V8.28H25.8927V5.52H27.4047V4.848C27.4047 3.216 27.8687 2.016 28.7967 1.248C29.7247 0.48 31.1247 0.12 32.9967 0.168001V3C32.1807 2.984 31.6127 3.12 31.2927 3.408C30.9727 3.696 30.8127 4.216 30.8127 4.968V5.52H33.1407V8.28Z" fill="#1D2939"/>
                        <path d="M49.2381 5.52L41.0061 25.104H37.4301L40.3101 18.48L34.9821 5.52H38.7501L42.1821 14.808L45.6621 5.52H49.2381Z" fill="#1D2939"/>
                        </g>
                        </svg>
                        `,
                    i = `<svg
                  id="closeIcon"
                  width="24"
                  height="24"
                  viewBox="0 0 24 24"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    d="M18 18L6 6M6 18L18 6"
                    stroke="white"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                </svg>`;
                if (!document.getElementById("dify-chatbot-bubble-button")) {
                    e = document.createElement("div");
                    (e.id = "dify-chatbot-bubble-button"),
                        (e.style.cssText =
                            "position: fixed; bottom: 1rem; right: 1rem; width: 50px; height: 50px; border-radius: 25px; background-color: #155EEF; box-shadow: rgba(0, 0, 0, 0.2) 0px 4px 8px 0px; cursor: pointer; z-index: 2147483647; transition: all 0.2s ease-in-out 0s; left: unset; transform: scale(1); :hover {transform: scale(1.1);}");
                    const d = document.createElement("div");
                    (d.style.cssText = "display: flex; align-items: center; justify-content: center; width: 100%; height: 100%; z-index: 2147483647;"),
                        (d.innerHTML = n),
                        e.appendChild(d),
                        document.body.appendChild(e),
                        e.addEventListener("click", function () {
                            var e = document.getElementById("dify-chatbot-bubble-window");
                            if (e) {
                                if ("none" === e.style.display) {
                                    e.style.display = "block";
                                    d.innerHTML = i;
                                } else {
                                    // Save the current URL before hiding the iframe
                                    localStorage.setItem('iframeUrl', e.src);
                                    e.style.display = "none";
                                    d.innerHTML = n;
                                }
                            } else {
                                // Retrieve the saved URL or use the default URL if none is saved
                                const savedUrl = localStorage.getItem('iframeUrl') || 'https://rag-test.dev.hyperplane.dev';
                                (e = document.createElement("iframe")).allow = "fullscreen;microphone";
                                e.title = "dify chatbot bubble window";
                                e.id = "dify-chatbot-bubble-window";
                                e.src = savedUrl;
                                e.style.cssText =
                                    "border: none; position: fixed; flex-direction: column; justify-content: space-between; box-shadow: rgba(150, 150, 150, 0.2) 0px 10px 30px 0px, rgba(150, 150, 150, 0.2) 0px 0px 0px 1px; bottom: 5rem; right: 1rem; width: 24rem; max-width: calc(100vw - 2rem); height: 40rem; max-height: calc(100vh - 6rem);border-radius: 0.75rem; display: flex; z-index: 2147483647; overflow: hidden; left: unset; background-color: #F3F4F6;";
                                document.body.appendChild(e);
                                d.innerHTML = i;
                            }
                        });
                }
            } else console.error("difyChatbotConfig is empty or token is not provided");
        }
        window.onload = embedChatbot;
    </script>
</head>
<body>
    <h1>Test my Dify app on the bottom right!</h1>
</body>
</html>